<%- include('partials/header')%>
<div class="flex-1 flex flex-col">
	<header
		class="bg-white p-4 shadow-sm border-b border-slate-200 flex items-center justify-between"
	>
		<h2 class="text-xl font-bold text-slate-700">All Tasks</h2>
		<button
			class="lg:hidden p-2 rounded-md hover:bg-slate-100 focus:outline-none focus:ring-2 focus:ring-violet-500"
		>
			<svg
				xmlns="http://www.w3.org/2000/svg"
				class="h-6 w-6"
				fill="none"
				viewBox="0 0 24 24"
				stroke="currentColor"
			>
				<path
					stroke-linecap="round"
					stroke-linejoin="round"
					stroke-width="2"
					d="M4 6h16M4 12h16m-7 6h7"
				/>
			</svg>
		</button>
	</header>

	<main class="flex-grow p-6 bg-slate-50">
		<div
			class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-2 gap-x-20 gap-y-8"
		>
			<% allTasks.forEach(task => { %>
			<div
				class="bg-white p-6 rounded-xl shadow-md border border-slate-200 hover:shadow-xl hover:-translate-y-1 transition-all flex flex-col"
			>
				<div class="flex-grow">
					<div class="flex items-center justify-between mb-4">
						<span
							class="text-sm font-medium px-3 py-1 rounded-full <%= task.status === 'completed' ? 'text-green-600 bg-green-100' : task.status === 'upcoming' ? 'text-yellow-600 bg-yellow-100' : 'text-red-600 bg-red-100' %>"
						>
							<%= task.status %>
						</span>

						<span class="text-sm text-slate-500"
							><%= new Date(task.taskDate).toLocaleDateString("en-US", { month: "short", day: "numeric", year: "numeric" }).replace(",", "") %></span
						>
					</div>
					<h4 class="font-bold text-lg text-slate-800 mb-2">
						<%= task.taskTitle %>
					</h4>
					<p class="text-slate-600 text-sm">
						<%= task.taskDescription %>
					</p>
				</div>
				<div
					class="<%= (task.status !== 'completed') ? 'mt-6 pt-4 border-t border-slate-200 flex items-center justify-between' : 'mt-6 pt-4 border-t border-slate-200 flex items-center justify-end gap-2' %>"
				>
					<!-- <div
                  class="mt-6 pt-4 border-t border-slate-200 flex items-center justify-end gap-2"
              > -->
					<% if(task.status!=="completed"){%>
					<form action="/mark-task-complete" method="post">
						<input
							type="hidden"
							name="taskId"
							value="<%= task._id%>"
						/>
						<button
							class="text-sm font-medium text-green-600 hover:text-green-800 flex items-center gap-1.5 px-3 py-1.5 rounded-md hover:bg-green-50 transition-colors"
						>
							<svg
								xmlns="http://www.w3.org/2000/svg"
								class="h-4 w-4"
								fill="none"
								viewBox="0 0 24 24"
								stroke="currentColor"
								stroke-width="2"
							>
								<path
									stroke-linecap="round"
									stroke-linejoin="round"
									d="M5 13l4 4L19 7"
								/>
							</svg>
							Complete
						</button>
					</form>
					<%}%>
					<div class="flex items-center gap-2">
						<a href="/edit-todoItem/<%= task._id %>?editing=true">
							<button
								class="text-sm font-medium text-slate-600 hover:text-blue-600 flex items-center gap-1.5 px-3 py-1.5 rounded-md hover:bg-slate-100 transition-colors"
							>
								<svg
									xmlns="http://www.w3.org/2000/svg"
									class="h-4 w-4"
									fill="none"
									viewBox="0 0 24 24"
									stroke="currentColor"
									stroke-width="2"
								>
									<path
										stroke-linecap="round"
										stroke-linejoin="round"
										d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.5L15.232 5.232z"
									/>
								</svg>
								Edit
							</button>
						</a>
						<form action="/all-tasks" method="post">
							<input
								type="text"
								hidden
								value="<%= task._id %>"
								name="todoItemId"
							/>
							<button
								class="text-sm font-medium text-slate-600 hover:text-red-600 flex items-center gap-1.5 px-3 py-1.5 rounded-md hover:bg-red-50 transition-colors"
							>
								<svg
									xmlns="http://www.w3.org/2000/svg"
									class="h-4 w-4"
									fill="none"
									viewBox="0 0 24 24"
									stroke="currentColor"
									stroke-width="2"
								>
									<path
										stroke-linecap="round"
										stroke-linejoin="round"
										d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"
									/>
								</svg>
								Delete
							</button>
						</form>
					</div>
				</div>
			</div>
			<% }) %>
		</div>
	</main>
	<%- include('partials/footer')%>
</div>
